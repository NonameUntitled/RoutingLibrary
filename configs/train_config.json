{
  "experiment_name": "basic_experiment",
  "type": "conveyor",
  "diverter": {
    "type": "addsdfsd",
    "here_we_need_some_variabes": 23,
    "here_we_need_some_variabes": true,
    "here_we_need_some_variabes": true,
    "here_we_need_some_variabes": true,
    "here_we_need_some_variabes": true,
    "here_we_need_some_variabes": true,
    "here_we_need_some_variabes": true
  },
  "conveyor": {
    "configuration": {
      "sinks": [
        0,
        1,
        2,
        3,
        4
      ],
      "sources": [
        {
          "upstream_conv": 0
        },
        {
          "upstream_conv": 5
        }
      ],
      "conveyors": [
        {
          "length": 40,
          "upstream": {
            "type": "sink",
            "idx": 0
          }
        },
        {
          "length": 10,
          "upstream": {
            "type": "sink",
            "idx": 1
          }
        },
        {
          "length": 5,
          "upstream": {
            "type": "conveyor",
            "idx": 3,
            "pos": 10
          }
        },
        {
          "length": 20,
          "upstream": {
            "type": "sink",
            "idx": 2
          }
        },
        {
          "length": 30,
          "upstream": {
            "type": "conveyor",
            "idx": 0,
            "pos": 10
          }
        },
        {
          "length": 40,
          "upstream": {
            "type": "sink",
            "idx": 3
          }
        },
        {
          "length": 10,
          "upstream": {
            "type": "sink",
            "idx": 4
          }
        },
        {
          "length": 25,
          "upstream": {
            "type": "conveyor",
            "idx": 5,
            "pos": 10
          }
        },
        {
          "length": 20,
          "upstream": {
            "type": "conveyor",
            "idx": 0,
            "pos": 5
          }
        },
        {
          "length": 60,
          "upstream": {
            "type": "conveyor",
            "idx": 5,
            "pos": 5
          }
        }
      ],
      "diverters": [
        {
          "conveyor": 0,
          "pos": 20,
          "upstream_conv": 9
        },
        {
          "conveyor": 0,
          "pos": 25,
          "upstream_conv": 3
        },
        {
          "conveyor": 0,
          "pos": 30,
          "upstream_conv": 1
        },
        {
          "conveyor": 1,
          "pos": 5,
          "upstream_conv": 2
        },
        {
          "conveyor": 3,
          "pos": 15,
          "upstream_conv": 4
        },
        {
          "conveyor": 5,
          "pos": 20,
          "upstream_conv": 8
        },
        {
          "conveyor": 5,
          "pos": 30,
          "upstream_conv": 6
        },
        {
          "conveyor": 6,
          "pos": 5,
          "upstream_conv": 7
        }
      ]
    }
  },
  "topology": {
    "type": "from_file",
    "filepath": "./tolopology"
  },
  "topology_2": {
    "type": "monte_carlo",
    "seed": 42,
    "sources_cnt": 10,
    "sinks_cnt": 10,
    "vertices_cnt": 10,
    "edges_cnt": 20,
    "generate_cycles": true,
    "min_edge_length": 10,
    "max_edge_length": 100,
    "length_distribution": "uniform"
  },
  "agent": {
    "type": "random",
    "neighbors_prefix": "neighbors_nodes",
    "output_prefix": "next_nodes"
  },
  "agent_2": {
    "type": "dqn",
    "parts": [
      {
        "type": "shared_embedding_encoder",
        "prefix": "current_node",
        "storage_prefix": "adj_matrix",
        "output_prefix": "current_node_emb"
      },
      {
        "type": "shared_embedding_encoder",
        "prefix": "neighbor_nodes",
        "storage_prefix": "adj_matrix",
        "output_prefix": "neighbor_nodes_emb"
      },
      {
        "type": "shared_embedding_encoder",
        "prefix": "destination_node",
        "storage_prefix": "adj_matrix",
        "output_prefix": "destination_node_emb"
      },
      {
        "type": "concat",
        "input_prefixes": [
          "neighbor_nodes_emb",
          "destination_node_emb",
          "adj_matrix",
          "current_node_emb"
        ],
        "dim": 1,
        "output_prefix": "combined_state"
      },
      {
        "type": "tower",
        "prefix": "combined_state",
        "hidden_dims": [
          64,
          64
        ],
        "output_dim": 100500,
        "output_prefix": "node_scores"
      },
      {
        "type": "softmax",
        "prefix": "node_scores",
        "dim": 1,
        "output_prefix": "next_nodes"
      }
    ]
  },
  "agent_3": {
    "type": "reinforce",
    "parts": [
      {
        "type": "shared_embedding_encoder",
        "prefix": "current_node",
        "embeddings_prefix": "graph",
        "output_prefix": "current_node"
      },
      {
        "type": "shared_embedding_encoder",
        "prefix": "neighbor_nodes",
        "embeddings_prefix": "graph",
        "output_prefix": "neighbor_nodes"
      },
      {
        "type": "shared_embedding_encoder",
        "prefix": "destination_node",
        "embeddings_prefix": "graph",
        "output_prefix": "destination_node"
      },
      {
        "type": "subtraction",
        "left_operand_prefix": "neighbor_nodes",
        "right_operand_prefix": "current_node",
        "output_prefix": "shifted_neighbors"
      },
      {
        "type": "subtraction",
        "left_operand_prefix": "destination_node",
        "right_operand_prefix": "current_node",
        "output_prefix": "shifted_destination"
      },
      {
        "type": "concat",
        "input_prefixes": [
          "shifted_neighbors",
          "shifted_destination"
        ],
        "dim": 1,
        "output_prefix": "combined_state"
      },
      {
        "type": "tower",
        "input_prefix": "combined_state",
        "input_dim": 20,
        "hidden_dims": [
          64,
          64
        ],
        "output_dim": 10,
        "output_prefix": "predicted_node_emb"
      },
      {
        "type": "euclidean_distance",
        "left_operand_prefix": "shifted_neighbors",
        "right_operand_prefix": "predicted_node_emb",
        "dim": 1,
        "output_prefix": "neighbors_probabilities"
      },
      {
        "type": "sample",
        "input_prefix": "neighbor_nodes",
        "proba_prefix": "neighbors_probabilities",
        "output_prefix": "next_nodes"
      }
    ]
  },
  "agent_4": {
    "type": "ppo",
    "node_idx": 0,
    "input_adapter": {
      "type": "ppo_input_adapter"
    },
    "actor": {
      "type": "tower_actor",
      "embedder": {
        "type": "shared_embedding_encoder"
      },
      "ff_net": {
        "type": "tower",
        "input_dim": 20,
        "hidden_dims": [
          64,
          64
        ],
        "output_dim": 1
      }
    },
    "critic": {
      "type": "tower_critic",
      "embedder": {
        "type": "shared_embedding_encoder"
      },
      "ff_net": {
        "type": "tower",
        "input_dim": 20,
        "hidden_dims": [
          64,
          64
        ],
        "output_dim": 1
      }
    },
    "path_memory": {
      "type": "shared_path_memory"
    }
  },
  "pretrain": {
    "type": "dijkstra",
    "stable_topology": true,
    "steps_num": 5000,
    "current_node_prefix": "current_node",
    "neighbors_nodes_prefix": 123,
    "target_node_prefix": 123,
    "next_node_prefix": 123,
    "optimizer": {
      "type": "adam"
    }
  },
  "train": {
    "multi_agent": true,
    "type": "scenario",
    "scenario_1": {
      "type": "from_file"
    },
    "scenario_2": {
      "type": "sequence"
    },
    "scenario_3": {
      "type": "random",
      "here_we_need_some_variabes": true
    }
  }
}
